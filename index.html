<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Care Games</title>
  <link rel="icon" type="image/png" href="assets/logo-care.png">

<style>
  :root{
    --bg:#ffffff;
    --black:#0b0b0b;

    /* warna segmen */
    --on:#e10000;                 /* merah nyala */
    --off: rgba(0,0,0,.06);       /* abu-abu mati (lebih samar) */

    --border:#e9e9e9;
    --muted:#666;

    --win:#12a150;
    --lose:#d40000;

    /* default scale logo */
    --logoScale: 1;
  }

  *{ box-sizing:border-box; }
  body{
    margin:0;
    height:100vh;
    background:var(--bg);
    color:var(--black);
    font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, "Noto Sans";
    display:flex;
    align-items:center;
    justify-content:center;
    user-select:none;
  }

  .logo-care{
    position: fixed;
    top: 16px;
    left: 16px;

    width: 130px;     /* ukuran dasar, nanti akan diskalakan */
    height: auto;

    transform: scale(var(--logoScale, 1));
    transform-origin: top left;

    z-index: 9999;
  }

  @media (max-width: 720px){
    .logo-care{
      width: 110px;
      top: 12px;
      left: 12px;
    }
  }

  .wrap{
    width:min(1100px, 96vw);
    height:100vh;
    padding:26px 16px 18px;
    display:flex;
    flex-direction:column;
    align-items:center;
    gap:14px;
  }

  .title{
    font-weight: 900;
    letter-spacing: .12em;
    text-transform: uppercase;
    font-size: clamp(18px, 3vw, 34px);
    text-align:center;
    margin-top: 8px;
    color: var(--black);
  }

  .panel{
    width: min(980px, 96vw);
    border-radius: 18px;
    border: 1px solid var(--border);
    background: #fff;
    padding: 18px 14px;
    display:flex;
    justify-content:center;
    align-items:center;
  }

  /* --- DISPLAY: [SS] : [CS] --- */
  .clock{
    width: 100%;
    display:flex;
    justify-content:center;
    align-items:center;
    gap: 18px;
  }

  .group{
    display:flex;
    align-items:center;
    gap: 10px;
    padding: 12px 12px;
    border-radius: 16px;
    border: 1px solid var(--border);
    background:#fff;
    overflow:hidden;
  }

  .digit{
    width: clamp(80px, 12vw, 165px);
    aspect-ratio: 1 / 2;
    position: relative;
    overflow:hidden;  /* penting: segmen tetap di dalam box */
  }
  .digit svg{
    width:100%;
    height:100%;
    display:block;
  }

  /* SEGMENT STYLE (FINAL) */
  .seg{
    fill: var(--off);           /* segmen mati */
    stroke: rgba(0,0,0,.08);    /* garis halus biar tegas */
    stroke-width: 2;            /* tebal garis */
    stroke-linejoin: round;     /* sudut halus */
    filter: none;               /* tidak ada shadow/glow */
  }

  .seg.on{
    fill: var(--on);            /* segmen nyala */
    stroke: rgba(0,0,0,.10);    /* sedikit outline biar tebal/solid */
    stroke-width: 2;
    stroke-linejoin: round;
    filter: none;               /* shadow dimatikan */
  }

  .colon{
    width: clamp(14px, 2.2vw, 30px);
    height: clamp(120px, 18vw, 260px);
    display:flex;
    flex-direction:column;
    align-items:center;
    justify-content:center;
    gap: clamp(16px, 2.4vw, 30px);
  }
  .dot{
    width: clamp(10px, 1.3vw, 16px);
    height: clamp(10px, 1.3vw, 16px);
    border-radius: 999px;
    background: var(--black);
    opacity:.9;
  }

  /* History */
  .history{
    width:min(980px, 96vw);
    margin-top: 6px;
  }
  .historyHead{
    display:flex;
    justify-content:space-between;
    align-items:baseline;
    gap:12px;
    margin: 10px 2px 8px;
    color: var(--muted);
    font-size: 12px;
    letter-spacing:.10em;
    text-transform: uppercase;
    font-weight: 800;
  }

  .list{
    border: 1px solid var(--border);
    border-radius: 16px;
    overflow:hidden;
    background: #fff;
    max-height: 30vh;
    overflow:auto;
  }
  .row{
    display:flex;
    justify-content:space-between;
    align-items:center;
    gap:12px;
    padding: 12px 14px;
    border-bottom: 1px solid var(--border);
    font-variant-numeric: tabular-nums;
  }
  .row:last-child{ border-bottom:none; }

  .left{
    display:flex;
    align-items:center;
    gap:10px;
    min-width: 170px;
  }
  .badge{
    font-size: 12px;
    font-weight: 900;
    letter-spacing:.10em;
    padding: 6px 10px;
    border-radius: 999px;
    border: 1px solid var(--border);
    background: #fff;
    text-transform:uppercase;
  }
  .badge.win{ color: var(--win); border-color: rgba(18,161,80,.35); }
  .badge.lose{ color: var(--lose); border-color: rgba(212,0,0,.25); }

  .attempt{
    color: var(--muted);
    font-size: 12px;
    font-weight: 700;
  }
  .time{
    font-weight: 900;
    color: var(--black);
    font-size: 13px;
    letter-spacing:.03em;
  }
  .diff{
    color: var(--muted);
    font-size: 12px;
    white-space: nowrap;
    text-align:right;
  }
  .empty{
    padding: 16px 14px;
    color: var(--muted);
    font-size: 13px;
    text-align:center;
  }

  @media (max-width: 720px){
    .clock{ gap: 12px; }
    .group{ gap: 8px; padding: 10px; }
  }
</style>

</head>

<body>
  <!-- ✅ LOGO kiri atas -->
  <img class="logo-care" src="assets/logo-care.png" alt="Logo Care" />

  <main class="wrap" id="screen">
    <div class="title">TARGET 10:00</div>

    <section class="panel">
      <div class="clock" aria-label="Digital timer">
        <!-- [SS] -->
        <div class="group">
          <div class="digit" id="s1"></div>
          <div class="digit" id="s2"></div>
        </div>

        <div class="colon" aria-hidden="true">
          <div class="dot"></div>
          <div class="dot"></div>
        </div>

        <!-- [CS] -->
        <div class="group">
          <div class="digit" id="c1"></div>
          <div class="digit" id="c2"></div>
        </div>
      </div>
    </section>

    <section class="history">
      <div class="historyHead">
        <div>Riwayat Percobaan</div>
      </div>

      <div class="list" id="list">
        <div class="empty" id="empty">Belum ada percobaan. Tekan Spasi untuk mulai.</div>
      </div>
    </section>
  </main>

  <script>
    // Target = 10 detik -> "10:00"
    const TARGET_TEXT = "10:00";
    const TARGET_SECONDS = 10.0;

    const listEl  = document.getElementById('list');
    const emptyEl = document.getElementById('empty');
    const screen  = document.getElementById('screen');

    let running = false;
    let startAt = 0;
    let rafId = null;
    let attempt = 0;

    const digitTemplate = `
  <svg viewBox="0 0 100 200" preserveAspectRatio="xMidYMid meet" aria-hidden="true">
    <!-- 7-seg klasik (diagonal ends + ada gap) -->

    <!-- a (top) -->
    <polygon class="seg" data-seg="a"
      points="24,10 76,10 84,18 76,26 24,26 16,18"></polygon>

    <!-- g (middle) -->
    <polygon class="seg" data-seg="g"
      points="24,92 76,92 84,100 76,108 24,108 16,100"></polygon>

    <!-- d (bottom) -->
    <polygon class="seg" data-seg="d"
      points="24,174 76,174 84,182 76,190 24,190 16,182"></polygon>

    <!-- f (top-left) -->
    <polygon class="seg" data-seg="f"
      points="10,30 18,22 26,30 26,86 18,94 10,86"></polygon>

    <!-- b (top-right) -->
    <polygon class="seg" data-seg="b"
      points="74,30 82,22 90,30 90,86 82,94 74,86"></polygon>

    <!-- e (bottom-left) -->
    <polygon class="seg" data-seg="e"
      points="10,114 18,106 26,114 26,170 18,178 10,170"></polygon>

    <!-- c (bottom-right) -->
    <polygon class="seg" data-seg="c"
      points="74,114 82,106 90,114 90,170 82,178 74,170"></polygon>
  </svg>
`;

    const segMap = {
      0: ["a","b","c","d","e","f"],
      1: ["b","c"],
      2: ["a","b","g","e","d"],
      3: ["a","b","c","d","g"],
      4: ["f","g","b","c"],
      5: ["a","f","g","c","d"],
      6: ["a","f","e","d","c","g"],
      7: ["a","b","c"],
      8: ["a","b","c","d","e","f","g"],
      9: ["a","b","c","d","f","g"],
    };

    function makeDigit(el){
      el.innerHTML = digitTemplate;
      return {
        el,
        segs: Array.from(el.querySelectorAll(".seg"))
      };
    }

    function setDigit(digitObj, num){
      const on = new Set(segMap[num] || []);
      for (const s of digitObj.segs){
        const name = s.dataset.seg;
        s.classList.toggle("on", on.has(name));
      }
    }

    const dS1 = makeDigit(document.getElementById("s1"));
    const dS2 = makeDigit(document.getElementById("s2"));
    const dC1 = makeDigit(document.getElementById("c1"));
    const dC2 = makeDigit(document.getElementById("c2"));

    const pad2 = (n) => String(n).padStart(2, "0");

    // SS:CS (centisecond)
    function parts(seconds){
      const totalCs = Math.max(0, Math.floor(seconds * 100)); // 1 cs = 10ms
      const ss = Math.floor(totalCs / 100);
      const cs = totalCs % 100;
      return { ss, cs };
    }

    function setDisplay(t){
      const { ss, cs } = parts(t);
      const ssTxt = pad2(ss);
      const csTxt = pad2(cs);

      setDigit(dS1, Number(ssTxt[0]));
      setDigit(dS2, Number(ssTxt[1]));
      setDigit(dC1, Number(csTxt[0]));
      setDigit(dC2, Number(csTxt[1]));
    }

    function displayText(t){
      const { ss, cs } = parts(t);
      return `${pad2(ss)}:${pad2(cs)}`;
    }

    function tick(){
      const now = performance.now();
      const t = (now - startAt) / 1000;
      setDisplay(t);
      rafId = requestAnimationFrame(tick);
    }

    function start(){
      running = true;
      startAt = performance.now();
      cancelAnimationFrame(rafId);
      rafId = requestAnimationFrame(tick);
    }

    function stop(){
      running = false;
      cancelAnimationFrame(rafId);

      const now = performance.now();
      const exact = (now - startAt) / 1000;

      setDisplay(exact);

      attempt++;
      const text = displayText(exact);
      const win = (text === TARGET_TEXT);
      const diff = exact - TARGET_SECONDS;

      addHistory({ attempt, win, timeText: text, diff });
    }

    function addHistory({attempt, win, timeText, diff}){
      if (emptyEl) emptyEl.remove();

      const row = document.createElement("div");
      row.className = "row";

      const left = document.createElement("div");
      left.className = "left";

      const badge = document.createElement("span");
      badge.className = `badge ${win ? "win" : "lose"}`;
      badge.textContent = win ? "WIN" : "LOSE";

      const att = document.createElement("span");
      att.className = "attempt";
      att.textContent = `#${attempt}`;

      left.appendChild(badge);
      left.appendChild(att);

      const mid = document.createElement("div");
      mid.className = "time";
      mid.textContent = timeText;

      const right = document.createElement("div");
      right.className = "diff";
      right.textContent = `selisih ${diff >= 0 ? "+" : ""}${diff.toFixed(3)} s`;

      row.appendChild(left);
      row.appendChild(mid);
      row.appendChild(right);

      listEl.prepend(row);
    }

    function toggle(){
      if (!running) start();
      else stop();
    }

    window.addEventListener("keydown", (e) => {
      if (e.code !== "Space") return;
      if (e.repeat) return;
      e.preventDefault();
      toggle();
    });

    // opsional klik layar
    screen.addEventListener("click", toggle);

    // ✅ Logo makin kecil saat zoom makin besar (DPR naik)
    function updateLogoScale(){
      const dpr = window.devicePixelRatio || 1;
      const scale = 1 / dpr;
      document.documentElement.style.setProperty('--logoScale', scale.toFixed(3));
    }
    window.addEventListener('resize', updateLogoScale);
    if (window.visualViewport) {
      window.visualViewport.addEventListener('resize', updateLogoScale);
      window.visualViewport.addEventListener('scroll', updateLogoScale);
    }
    updateLogoScale();

    // init
    setDisplay(0);
  </script>
</body>
</html>


